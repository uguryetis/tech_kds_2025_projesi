<!DOCTYPE html>
<html lang="tr">
<head>
  <%- include('partials/head', { title }) %>
</head>
<body>
  <div class="wrapper">
    <%- include('partials/nav', { activePage }) %>

    <main class="main-content">
      <h1 class="page-title">Şube Ciro Analizi</h1>

      <div class="card">
        <form action="/sube-ciro" method="get" class="filter-bar">
          <div class="filter-group">
            <label for="ay">Ay Seç (Aylık Ciro)</label>
            <select name="ay" id="ay">
              <% months.forEach((m, idx) => { %>
                <option value="<%= idx+1 %>" <%= (seciliAy === idx+1) ? 'selected' : '' %>>
                  <%= m %>
                </option>
              <% }) %>
            </select>
          </div>
          <button type="submit" class="btn-primary">
            <i class="fa-solid fa-filter"></i>
            Verileri Göster
          </button>
        </form>
      </div>

      <div class="card-large-chart">
        <canvas id="ciroChart"></canvas>
      </div>
    </main>
  </div>

  <script>
    const ciroLabels = <%- JSON.stringify(barLabels) %>;
    const ciroData   = <%- JSON.stringify(barData) %>;
    const ciroColors = <%- JSON.stringify(barColors) %>;

    const ctx = document.getElementById('ciroChart').getContext('2d');

    new Chart(ctx, {
      type: 'bar',
      data: {
        labels: ciroLabels,
        datasets: [{
          label: 'Aylık Ciro (Milyon TL)',
          data: ciroData,
          backgroundColor: ciroColors
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          y: {
            beginAtZero: true,
            title: { display: true, text: 'Ciro (Milyon TL)' }
          }
        },
        plugins: {
          legend: { display: false },
          title: {
            display: true,
            text: 'Seçili Aya Göre Şube Ciro Dağılımı (2025)'
          }
        }
      }
    });
  </script>
</body>
</html>




